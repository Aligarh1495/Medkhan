{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ title }}{% endblock %}</title>

    <!-- Базовые стили -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% block extra_css %}{% endblock %}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    {% block meta_description %}{% endblock %}
    {% block meta_keywords %}{% endblock %}
    {% block structured_data %}{% endblock %}
</head>
<body>
    <!-- Шапка сайта -->
    <header class="header">
        <div class="container header-container">
            <a href="{% url 'main' %}" class="logo">
                <img src="{% static 'images/лого_верх.png' %}" alt="MedKhan">
            </a>
            <div class="phone-number">
                <a href="tel:+79011433434">+7 (901) 143-34-34</a>
            </div>

            <!-- Мобильное меню -->
            <button class="mobile-menu-toggle" aria-label="Открыть меню">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <nav class="main-nav">
                <ul>
                    <li><a href="{% url 'services' %}" {% if 'services' in request.path %}class="active"{% endif %}>Услуги</a></li>
                    <li><a href="{% url 'stocks' %}" {% if 'stocks' in request.path %}class="active"{% endif %}>Акции</a></li>
                    <li><a href="{% url 'specialists' %}" {% if 'specialists' in request.path %}class="active"{% endif %}>Специалисты</a></li>
                    <li><a href="#reviews" {% if 'reviews' in request.path %}class="active"{% endif %}>Отзывы</a></li>
                    <li><a href="{% url 'magazine' %}" {% if 'magazine' in request.path %}class="active"{% endif %}>Журнал</a></li>
                </ul>
            </nav>

            <!-- Активная кнопка записи -->
            <a href="https://booking.medflex.ru?user=33f85b2ad6c658bc5ed6f3e1afb512a6&source=3"
               target="_blank"
               class="btn btn-primary booking-btn"
               rel="noopener noreferrer">
                Записаться
            </a>
        </div>
    </header>

    <!-- Основной контент -->
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <!-- Информационный блок -->
    <section class="info-section">
        <div class="container">
            <div class="magazine-info-section">
                <!-- Контактный блок -->
                <div class="contact-block">
                    <div class="logo-container">
                        <div class="logo-text">
                            <img src="{% static 'images/logo.png' %}" alt="MedKhan Logo">
                        </div>
                    </div>
                    <div class="contact-info">
                        <p class="contact-address">Набережные Челны,<br>52-й комплекс, 20А</p>
                        <a href="tel:+79011433434" class="contact-phone">+7 (901) 143-34-34</a>
                    </div>
                    <div class="contact-message">
                        <p>Пишите<br>нам по любым<br>вопросам</p>
                        <div class="contact-icons">
                            <a href="mailto:medkhan@mail.ru" class="icon-email" aria-label="Написать email" target="_blank" rel="noopener noreferrer">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </a>
                            <a href="https://t.me/medkhancl" class="icon-telegram" aria-label="Написать в Telegram" target="_blank" rel="noopener noreferrer">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </a>
                            <a href="https://vk.com/medkhanc" class="icon-vk" aria-label="Написать в ВКонтакте" target="_blank" rel="noopener noreferrer">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill="white" d="M20.14 7.43C20.31 6.86 20.14 6.5 19.34 6.5H17.72C17.05 6.5 16.75 6.83 16.57 7.23C16.57 7.23 15.53 9.67 14.13 11.07C13.71 11.49 13.5 11.62 13.27 11.62C13.1 11.62 12.89 11.49 12.89 11.03V7.43C12.89 6.77 12.7 6.5 12.18 6.5H9.83C9.41 6.5 9.15 6.78 9.15 7.05C9.15 7.68 10.09 7.83 10.22 9.36V11.03C10.22 11.75 10.08 11.88 9.85 11.88C9.42 11.88 8.48 10.77 7.7 8.79C7.42 8.06 7.16 7.5 6.49 7.5H4.86C4.14 7.5 4 7.83 4 8.23C4 8.93 4.87 10.08 5.81 11.19C6.75 12.3 8.09 13.5 9.83 13.5H10.22V16.5C10.22 17.16 10.41 17.43 10.94 17.43H13.27C13.7 17.43 13.89 17.16 13.89 16.5V14.83C13.89 14.11 14.03 13.98 14.26 13.98C14.69 13.98 15.63 15.09 16.41 17.07C16.69 17.8 16.95 18.36 17.62 18.36H19.25C19.97 18.36 20.08 18.03 20.08 17.63C20.08 16.93 19.21 15.78 18.27 14.67C17.33 13.56 16.08 12.36 16.08 12.36C16.08 12.36 20.14 7.43 20.14 7.43Z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Лицензия -->
                <div class="license-block">
                    <h3>Лицензия<br>на медицинскую<br>деятельность</h3>
                    <a href="{% static 'images/Лицензия 2024.BMP' %}" target="_blank" class="verify-license">проверить лицензию</a>
                </div>

                <!-- Рейтинги -->
                <div class="ratings-block">
                    <div class="rating-card">
                        <span class="rating-score">4.7</span>
                        <a href="https://clck.ru/3NHwZa" target="_blank" rel="noopener noreferrer">
                            <img src="{% static 'images/yandex_logo.png' %}" alt="Яндекс" class="rating-logo yandex-logo">
                        </a>
                    </div>
                    <div class="rating-card">
                        <span class="rating-score">4.6</span>
                        <a href="https://clck.ru/3NHyhu" target="_blank" rel="noopener noreferrer">
                            <img src="{% static 'images/gis_logo.png' %}" alt="2ГИС" class="rating-logo gis-logo">
                        </a>
                    </div>
                </div>
            </div>

            <!-- Социальные сети -->
            <div class="magazine-social-links">
                <a href="https://t.me/medkhancl" class="magazine-social-link telegram" target="_blank" rel="noopener noreferrer">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="#00C087" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    MedKhan в тг
                </a>
                <a href="https://vk.com/medkhanc" class="magazine-social-link vk" target="_blank" rel="noopener noreferrer">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path stroke="#00C087" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M20.14 7.43C20.31 6.86 20.14 6.5 19.34 6.5H17.72C17.05 6.5 16.75 6.83 16.57 7.23C16.57 7.23 15.53 9.67 14.13 11.07C13.71 11.49 13.5 11.62 13.27 11.62C13.1 11.62 12.89 11.49 12.89 11.03V7.43C12.89 6.77 12.7 6.5 12.18 6.5H9.83C9.41 6.5 9.15 6.78 9.15 7.05C9.15 7.68 10.09 7.83 10.22 9.36V11.03C10.22 11.75 10.08 11.88 9.85 11.88C9.42 11.88 8.48 10.77 7.7 8.79C7.42 8.06 7.16 7.5 6.49 7.5H4.86C4.14 7.5 4 7.83 4 8.23C4 8.93 4.87 10.08 5.81 11.19C6.75 12.3 8.09 13.5 9.83 13.5H10.22V16.5C10.22 17.16 10.41 17.43 10.94 17.43H13.27C13.7 17.43 13.89 17.16 13.89 16.5V14.83C13.89 14.11 14.03 13.98 14.26 13.98C14.69 13.98 15.63 15.09 16.41 17.07C16.69 17.8 16.95 18.36 17.62 18.36H19.25C19.97 18.36 20.08 18.03 20.08 17.63C20.08 16.93 19.21 15.78 18.27 14.67C17.33 13.56 16.08 12.36 16.08 12.36C16.08 12.36 20.14 7.43 20.14 7.43Z"/>
<!--                      <path fill="white" d="M20.14 7.43C20.31 6.86 20.14 6.5 19.34 6.5H17.72C17.05 6.5 16.75 6.83 16.57 7.23C16.57 7.23 15.53 9.67 14.13 11.07C13.71 11.49 13.5 11.62 13.27 11.62C13.1 11.62 12.89 11.49 12.89 11.03V7.43C12.89 6.77 12.7 6.5 12.18 6.5H9.83C9.41 6.5 9.15 6.78 9.15 7.05C9.15 7.68 10.09 7.83 10.22 9.36V11.03C10.22 11.75 10.08 11.88 9.85 11.88C9.42 11.88 8.48 10.77 7.7 8.79C7.42 8.06 7.16 7.5 6.49 7.5H4.86C4.14 7.5 4 7.83 4 8.23C4 8.93 4.87 10.08 5.81 11.19C6.75 12.3 8.09 13.5 9.83 13.5H10.22V16.5C10.22 17.16 10.41 17.43 10.94 17.43H13.27C13.7 17.43 13.89 17.16 13.89 16.5V14.83C13.89 14.11 14.03 13.98 14.26 13.98C14.69 13.98 15.63 15.09 16.41 17.07C16.69 17.8 16.95 18.36 17.62 18.36H19.25C19.97 18.36 20.08 18.03 20.08 17.63C20.08 16.93 19.21 15.78 18.27 14.67C17.33 13.56 16.08 12.36 16.08 12.36C16.08 12.36 20.14 7.43 20.14 7.43Z"/>-->
                    </svg>
                    MedKhan в вк
                </a>
                <a href="mailto:medkhan@mail.ru" class="magazine-social-link youtube" target="_blank" rel="noopener noreferrer">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="#00C087" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22 6L12 13L2 6" stroke="#00C087" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Medkhan почта
                </a>
            </div>

            <!-- Футер -->
            <footer class="magazine-footer">
                <p class="copyright">© 2023-2025 г. «Медицинский центр МедХан»</p>
                <div class="footer-links">
                    <a href="#" class="privacy-policy">Политика конфиденциальности</a>
                    <a href="#" class="requisites">Реквизиты</a>
                </div>
            </footer>
        </div>
    </section>

    <!-- Круглый виджет онлайн-записи MedFlex -->
    <div id="medflexRoundWidgetData" data-src="https://booking.medflex.ru?user=33f85b2ad6c658bc5ed6f3e1afb512a6&isRoundWidget=true"></div>

    <!-- Дополнительные скрипты -->
    {% block extra_js %}{% endblock %}

    <!-- Скрипт виджета онлайн-записи -->
    <script defer src="https://booking.medflex.ru/components/round/round_widget_button.js" charset="utf-8"></script>

    <!-- Базовые скрипты -->
    <script>
        // Мобильное меню
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            const mainNav = document.querySelector('.main-nav');

            if (mobileMenuToggle && mainNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    mainNav.classList.toggle('active');
                    this.classList.toggle('active');
                });

                // Закрытие меню при клике на ссылку
                const navLinks = mainNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        mainNav.classList.remove('active');
                        mobileMenuToggle.classList.remove('active');
                    });
                });

                // Закрытие меню при клике вне его
                document.addEventListener('click', function(event) {
                    if (!mainNav.contains(event.target) && !mobileMenuToggle.contains(event.target)) {
                        mainNav.classList.remove('active');
                        mobileMenuToggle.classList.remove('active');
                    }
                });
            }

            // Плавная прокрутка для якорных ссылок
            const anchorLinks = document.querySelectorAll('a[href^="#"]');
            anchorLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href !== '#' && href.length > 1) {
                        const target = document.querySelector(href);
                        if (target) {
                            e.preventDefault();
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });

            // Отслеживание активной страницы в навигации
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.main-nav a');

            navLinks.forEach(link => {
                const linkPath = new URL(link.href).pathname;
                if (currentPath.includes(linkPath) && linkPath !== '/') {
                    link.classList.add('active');
                }
            });
        });

        // Функция для открытия виджета записи с параметрами
        function openBookingWidget(doctorId = null, serviceId = null) {
            let bookingUrl = 'https://booking.medflex.ru?user=33f85b2ad6c658bc5ed6f3e1afb512a6&source=3';

            if (doctorId) {
                bookingUrl += `&doctor=${doctorId}`;
            }

            if (serviceId) {
                bookingUrl += `&service=${serviceId}`;
            }

            window.open(bookingUrl, '_blank', 'noopener,noreferrer');
        }

        // Глобальная функции для записи к врачу
        window.bookAppointment = function(doctorId, serviceId) {
            openBookingWidget(doctorId, serviceId);
        };
    </script>
</body>
</html>
